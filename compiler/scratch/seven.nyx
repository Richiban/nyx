
type Async(a) = #done(a) | #pending(a)

def main = {
  def await = { 
    | #pending(v), cont -> (cont(v))
    | #done(v), cont -> (cont(v))
  }

  def fromResult: a -> Async(a) = { r -> #done(r) }

  def a = fromResult(5)

  def b = await! a

  def c = b + 1
    
  dbg(c)
}

main()